!function(e,t){"function"==typeof define&&define.amd?define(["./blockly_compressed.js"],t):"object"==typeof exports?module.exports=t(require("./blockly_compressed.js")):(e.javascript=t(e.Blockly),e.Blockly.JavaScript=e.javascript.javascriptGenerator)}(this,function(e){function t(t,n){var r=0;let a="";n.STATEMENT_PREFIX&&(a+=n.injectId(n.STATEMENT_PREFIX,t));do{var o=n.valueToCode(t,"IF"+r,N.NONE)||"false";let e=n.statementToCode(t,"DO"+r);n.STATEMENT_SUFFIX&&(e=n.prefixLines(n.injectId(n.STATEMENT_SUFFIX,t),n.INDENT)+e),a+=(0<r?" else ":"")+"if ("+o+") {\n"+e+"}",r++}while(t.getInput("IF"+r));return(t.getInput("ELSE")||n.STATEMENT_SUFFIX)&&(r=n.statementToCode(t,"ELSE"),n.STATEMENT_SUFFIX&&(r=n.prefixLines(n.injectId(n.STATEMENT_SUFFIX,t),n.INDENT)+r),a+=" else {\n"+r+"}"),a+"\n"}function n(e,t){let n;n=e.getField("TIMES")?String(Number(e.getFieldValue("TIMES"))):t.valueToCode(e,"TIMES",N.ASSIGNMENT)||"0";var r=t.statementToCode(e,"DO"),r=t.addLoopTrap(r,e),a=(e="",t.nameDB_.getDistinctName("count",E.NameType$$module$build$src$core$names.VARIABLE));let o=n;return n.match(/^\w+$/)||E.isNumber$$module$build$src$core$utils$string(n)||(e+="var "+(o=t.nameDB_.getDistinctName("repeat_end",E.NameType$$module$build$src$core$names.VARIABLE))+" = "+n+";\n"),e+("for (var "+a+" = 0; "+a+" < "+o)+"; "+a+"++) {\n"+r+"}\n"}function r(e,t){var n=e.getFieldValue("OP");let r;if("NEG"===n)return["-"+(e="-"===(e=t.valueToCode(e,"NUM",N.UNARY_NEGATION)||"0")[0]?" "+e:e),N.UNARY_NEGATION];switch(e="SIN"===n||"COS"===n||"TAN"===n?t.valueToCode(e,"NUM",N.DIVISION)||"0":t.valueToCode(e,"NUM",N.NONE)||"0",n){case"ABS":r="Math.abs("+e+")";break;case"ROOT":r="Math.sqrt("+e+")";break;case"LN":r="Math.log("+e+")";break;case"EXP":r="Math.exp("+e+")";break;case"POW10":r="Math.pow(10,"+e+")";break;case"ROUND":r="Math.round("+e+")";break;case"ROUNDUP":r="Math.ceil("+e+")";break;case"ROUNDDOWN":r="Math.floor("+e+")";break;case"SIN":r="Math.sin("+e+" / 180 * Math.PI)";break;case"COS":r="Math.cos("+e+" / 180 * Math.PI)";break;case"TAN":r="Math.tan("+e+" / 180 * Math.PI)"}if(r)return[r,N.FUNCTION_CALL];switch(n){case"LOG10":r="Math.log("+e+") / Math.log(10)";break;case"ASIN":r="Math.asin("+e+") / Math.PI * 180";break;case"ACOS":r="Math.acos("+e+") / Math.PI * 180";break;case"ATAN":r="Math.atan("+e+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+n)}return[r,N.DIVISION]}function a(e,t){var n=t.getProcedureName(e.getFieldValue("NAME")),r="";t.STATEMENT_PREFIX&&(r+=t.injectId(t.STATEMENT_PREFIX,e)),t.STATEMENT_SUFFIX&&(r+=t.injectId(t.STATEMENT_SUFFIX,e)),r=r&&t.prefixLines(r,t.INDENT);let a="";t.INFINITE_LOOP_TRAP&&(a=t.prefixLines(t.injectId(t.INFINITE_LOOP_TRAP,e),t.INDENT));var o=t.statementToCode(e,"STACK");let i=t.valueToCode(e,"RETURN",N.NONE)||"",u="";o&&i&&(u=r),i=i&&t.INDENT+"return "+i+";\n";const l=[],s=e.getVars();for(let e=0;e<s.length;e++)l[e]=t.getVariableName(s[e]);return r="function "+n+"("+l.join(", ")+") {\n"+r+a+o+u+i+"}",r=t.scrub_(e,r),t.definitions_["%"+n]=r,null}function o(e,t){return t="window.prompt("+(e.getField("TEXT")?t.quote_(e.getFieldValue("TEXT")):t.valueToCode(e,"TEXT",N.NONE)||"''")+")",[t="NUMBER"===e.getFieldValue("TYPE")?"Number("+t+")":t,N.FUNCTION_CALL]}function i(e,t){return[t.getVariableName(e.getFieldValue("VAR")),N.ATOMIC]}function u(e,t){var n=t.valueToCode(e,"VALUE",N.ASSIGNMENT)||"0";return t.getVariableName(e.getFieldValue("VAR"))+" = "+n+";\n"}function l(e,t,n){return"FIRST"===t?"0":"FROM_END"===t?e+".length - 1 - "+n:"LAST"===t?e+".length - 1":n}function s(e){return L.test(e)?[e,N.ATOMIC]:["String("+e+")",N.FUNCTION_CALL]}function T(e,t,n){return"FIRST"===t?"0":"FROM_END"===t?e+".length - 1 - "+n:"LAST"===t?e+".length - 1":n}var N,E=e.__namespace__,e=((e=N=N||{})[e.ATOMIC=0]="ATOMIC",e[e.NEW=1.1]="NEW",e[e.MEMBER=1.2]="MEMBER",e[e.FUNCTION_CALL=2]="FUNCTION_CALL",e[e.INCREMENT=3]="INCREMENT",e[e.DECREMENT=3]="DECREMENT",e[e.BITWISE_NOT=4.1]="BITWISE_NOT",e[e.UNARY_PLUS=4.2]="UNARY_PLUS",e[e.UNARY_NEGATION=4.3]="UNARY_NEGATION",e[e.LOGICAL_NOT=4.4]="LOGICAL_NOT",e[e.TYPEOF=4.5]="TYPEOF",e[e.VOID=4.6]="VOID",e[e.DELETE=4.7]="DELETE",e[e.AWAIT=4.8]="AWAIT",e[e.EXPONENTIATION=5]="EXPONENTIATION",e[e.MULTIPLICATION=5.1]="MULTIPLICATION",e[e.DIVISION=5.2]="DIVISION",e[e.MODULUS=5.3]="MODULUS",e[e.SUBTRACTION=6.1]="SUBTRACTION",e[e.ADDITION=6.2]="ADDITION",e[e.BITWISE_SHIFT=7]="BITWISE_SHIFT",e[e.RELATIONAL=8]="RELATIONAL",e[e.IN=8]="IN",e[e.INSTANCEOF=8]="INSTANCEOF",e[e.EQUALITY=9]="EQUALITY",e[e.BITWISE_AND=10]="BITWISE_AND",e[e.BITWISE_XOR=11]="BITWISE_XOR",e[e.BITWISE_OR=12]="BITWISE_OR",e[e.LOGICAL_AND=13]="LOGICAL_AND",e[e.LOGICAL_OR=14]="LOGICAL_OR",e[e.CONDITIONAL=15]="CONDITIONAL",e[e.ASSIGNMENT=16]="ASSIGNMENT",e[e.YIELD=17]="YIELD",e[e.COMMA=18]="COMMA",e[e.NONE=99]="NONE",class extends E.CodeGenerator$$module$build$src$core$generator{constructor(e="JavaScript"){super(e),this.ORDER_OVERRIDES=[[N.FUNCTION_CALL,N.MEMBER],[N.FUNCTION_CALL,N.FUNCTION_CALL],[N.MEMBER,N.MEMBER],[N.MEMBER,N.FUNCTION_CALL],[N.LOGICAL_NOT,N.LOGICAL_NOT],[N.MULTIPLICATION,N.MULTIPLICATION],[N.ADDITION,N.ADDITION],[N.LOGICAL_AND,N.LOGICAL_AND],[N.LOGICAL_OR,N.LOGICAL_OR]],this.isInitialized=!1;for(const t in N)e=N[t],"string"!=typeof e&&(this["ORDER_"+t]=e);this.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(globalThis).join(","))}init(e){super.init(e),this.nameDB_?this.nameDB_.reset():this.nameDB_=new E.Names$$module$build$src$core$names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap(e.getVariableMap()),this.nameDB_.populateVariables(e),this.nameDB_.populateProcedures(e);const t=[];var n=E.allDeveloperVariables$$module$build$src$core$variables(e);for(let e=0;e<n.length;e++)t.push(this.nameDB_.getName(n[e],E.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE));for(e=E.allUsedVarModels$$module$build$src$core$variables(e),n=0;n<e.length;n++)t.push(this.nameDB_.getName(e[n].getId(),E.NameType$$module$build$src$core$names.VARIABLE));t.length&&(this.definitions_.variables="var "+t.join(", ")+";"),this.isInitialized=!0}finish(e){const t=Object.values(this.definitions_);return super.finish(e),this.isInitialized=!1,this.nameDB_.reset(),t.join("\n\n")+"\n\n\n"+e}scrubNakedValue(e){return e+";\n"}quote_(e){return"'"+(e=e.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"))+"'"}multiline_quote_(e){return e.split(/\n/g).map(this.quote_).join(" + '\\n' +\n")}scrub_(t,e,n=!1){let r="";if(!t.outputConnection||!t.outputConnection.targetConnection){var a=t.getCommentText();a&&(a=E.wrap$$module$build$src$core$utils$string(a,this.COMMENT_WRAP-3),r+=this.prefixLines(a+"\n","// "));for(let e=0;e<t.inputList.length;e++)t.inputList[e].type===E.inputTypes$$module$build$src$core$inputs$input_types.VALUE&&(a=t.inputList[e].connection.targetBlock())&&(a=this.allNestedComments(a))&&(r+=this.prefixLines(a,"// "))}return t=t.nextConnection&&t.nextConnection.targetBlock(),n=n?"":this.blockToCode(t),r+e+n}getAdjusted(e,t,n=0,r=!1,a=N.NONE){e.workspace.options.oneBasedIndex&&n--;var o=e.workspace.options.oneBasedIndex?"1":"0";let i=a;return 0<n?i=N.ADDITION:n<0?i=N.SUBTRACTION:r&&(i=N.UNARY_NEGATION),e=this.valueToCode(e,t,i)||o,0!==n||r?E.isNumber$$module$build$src$core$utils$string(e)?(e=String(Number(e)+n),e=r?String(-Number(e)):e):(0<n?e=e+" + "+n:n<0&&(e=e+" - "+-n),r&&(e=n?`-(${e})`:"-"+e),Math.floor(a)>=Math.floor(i)?`(${e})`:e):e}}),c={},c=(c.JavascriptGenerator=e,c.Order=N,{}),I=(c.colour_blend=function(e,t){var n=t.valueToCode(e,"COLOUR1",N.NONE)||"'#000000'",r=t.valueToCode(e,"COLOUR2",N.NONE)||"'#000000'";return e=t.valueToCode(e,"RATIO",N.NONE)||.5,[t.provideFunction_("colourBlend",`
function ${t.FUNCTION_NAME_PLACEHOLDER_}(c1, c2, ratio) {
  ratio = Math.max(Math.min(Number(ratio), 1), 0);
  var r1 = parseInt(c1.substring(1, 3), 16);
  var g1 = parseInt(c1.substring(3, 5), 16);
  var b1 = parseInt(c1.substring(5, 7), 16);
  var r2 = parseInt(c2.substring(1, 3), 16);
  var g2 = parseInt(c2.substring(3, 5), 16);
  var b2 = parseInt(c2.substring(5, 7), 16);
  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);
  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);
  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);
  r = ('0' + (r || 0).toString(16)).slice(-2);
  g = ('0' + (g || 0).toString(16)).slice(-2);
  b = ('0' + (b || 0).toString(16)).slice(-2);
  return '#' + r + g + b;
}
`)+"("+n+", "+r+", "+e+")",N.FUNCTION_CALL]},c.colour_picker=function(e,t){return[t.quote_(e.getFieldValue("COLOUR")),N.ATOMIC]},c.colour_random=function(e,t){return[t.provideFunction_("colourRandom",`
function ${t.FUNCTION_NAME_PLACEHOLDER_}() {
  var num = Math.floor(Math.random() * Math.pow(2, 24));
  return '#' + ('00000' + num.toString(16)).substr(-6);
}
`)+"()",N.FUNCTION_CALL]},c.colour_rgb=function(e,t){var n=t.valueToCode(e,"RED",N.NONE)||0,r=t.valueToCode(e,"GREEN",N.NONE)||0;return e=t.valueToCode(e,"BLUE",N.NONE)||0,[t.provideFunction_("colourRgb",`
function ${t.FUNCTION_NAME_PLACEHOLDER_}(r, g, b) {
  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;
  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;
  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;
  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);
  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);
  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);
  return '#' + r + g + b;
}
`)+"("+n+", "+r+", "+e+")",N.FUNCTION_CALL]},{lists_create_empty:function(e,t){return["[]",N.ATOMIC]},lists_create_with:function(t,n){const r=Array(t.itemCount_);for(let e=0;e<t.itemCount_;e++)r[e]=n.valueToCode(t,"ADD"+e,N.NONE)||"null";return["["+r.join(", ")+"]",N.ATOMIC]},lists_getIndex:function(e,t){var n=e.getFieldValue("MODE")||"GET",r=e.getFieldValue("WHERE")||"FROM_START",a=t.valueToCode(e,"VALUE","RANDOM"===r?N.NONE:N.MEMBER)||"[]";switch(r){case"FIRST":if("GET"===n)return[a+"[0]",N.MEMBER];if("GET_REMOVE"===n)return[a+".shift()",N.MEMBER];if("REMOVE"===n)return a+".shift();\n";break;case"LAST":if("GET"===n)return[a+".slice(-1)[0]",N.MEMBER];if("GET_REMOVE"===n)return[a+".pop()",N.MEMBER];if("REMOVE"===n)return a+".pop();\n";break;case"FROM_START":if(e=t.getAdjusted(e,"AT"),"GET"===n)return[a+"["+e+"]",N.MEMBER];if("GET_REMOVE"===n)return[a+".splice("+e+", 1)[0]",N.FUNCTION_CALL];if("REMOVE"===n)return a+".splice("+e+", 1);\n";break;case"FROM_END":if(e=t.getAdjusted(e,"AT",1,!0),"GET"===n)return[a+".slice("+e+")[0]",N.FUNCTION_CALL];if("GET_REMOVE"===n)return[a+".splice("+e+", 1)[0]",N.FUNCTION_CALL];if("REMOVE"===n)return a+".splice("+e+", 1);";break;case"RANDOM":if(a=t.provideFunction_("listsGetRandomItem",`
function ${t.FUNCTION_NAME_PLACEHOLDER_}(list, remove) {
  var x = Math.floor(Math.random() * list.length);
  if (remove) {
    return list.splice(x, 1)[0];
  } else {
    return list[x];
  }
}
`)+"("+a+", "+("GET"!==n)+")","GET"===n||"GET_REMOVE"===n)return[a,N.FUNCTION_CALL];if("REMOVE"===n)return a+";\n"}throw Error("Unhandled combination (lists_getIndex).")},lists_getSublist:function(e,t){var n={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"},r=t.valueToCode(e,"LIST",N.MEMBER)||"[]",a=e.getFieldValue("WHERE1"),o=e.getFieldValue("WHERE2");if("FIRST"===a&&"LAST"===o)r+=".slice(0)";else if(r.match(/^\w+$/)||"FROM_END"!==a&&"FROM_START"===o){switch(a){case"FROM_START":n=t.getAdjusted(e,"AT1");break;case"FROM_END":n=r+".length - "+(n=t.getAdjusted(e,"AT1",1,!1,N.SUBTRACTION));break;case"FIRST":n="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(o){case"FROM_START":t=t.getAdjusted(e,"AT2",1);break;case"FROM_END":t=r+".length - "+(t=t.getAdjusted(e,"AT2",0,!1,N.SUBTRACTION));break;case"LAST":t=r+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}r=r+".slice("+n+", "+t+")"}else{var i=t.getAdjusted(e,"AT1");e=t.getAdjusted(e,"AT2"),r=t.provideFunction_("subsequence"+n[a]+n[o],`
function ${t.FUNCTION_NAME_PLACEHOLDER_}(sequence${"FROM_END"===a||"FROM_START"===a?", at1":""}${"FROM_END"===o||"FROM_START"===o?", at2":""}) {
  var start = ${l("sequence",a,"at1")};
  var end = ${l("sequence",o,"at2")} + 1;
  return sequence.slice(start, end);
}
`)+"("+r+("FROM_END"===a||"FROM_START"===a?", "+i:"")+("FROM_END"===o||"FROM_START"===o?", "+e:"")+")"}return[r,N.FUNCTION_CALL]},lists_indexOf:function(e,t){var n="FIRST"===e.getFieldValue("END")?"indexOf":"lastIndexOf",r=t.valueToCode(e,"FIND",N.NONE)||"''";return t=(t.valueToCode(e,"VALUE",N.MEMBER)||"[]")+"."+n+"("+r+")",e.workspace.options.oneBasedIndex?[t+" + 1",N.ADDITION]:[t,N.FUNCTION_CALL]},lists_isEmpty:function(e,t){return["!"+(t.valueToCode(e,"VALUE",N.MEMBER)||"[]")+".length",N.LOGICAL_NOT]},lists_length:function(e,t){return[(t.valueToCode(e,"VALUE",N.MEMBER)||"[]")+".length",N.MEMBER]},lists_repeat:function(e,t){return[t.provideFunction_("listsRepeat",`
function ${t.FUNCTION_NAME_PLACEHOLDER_}(value, n) {
  var array = [];
  for (var i = 0; i < n; i++) {
    array[i] = value;
  }
  return array;
}
`)+"("+(t.valueToCode(e,"ITEM",N.NONE)||"null")+", "+(e=t.valueToCode(e,"NUM",N.NONE)||"0")+")",N.FUNCTION_CALL]},lists_reverse:function(e,t){return[(t.valueToCode(e,"LIST",N.FUNCTION_CALL)||"[]")+".slice().reverse()",N.FUNCTION_CALL]},lists_setIndex:function(e,n){function t(){if(r.match(/^\w+$/))return"";var e=n.nameDB_.getDistinctName("tmpList",E.NameType$$module$build$src$core$names.VARIABLE),t="var "+e+" = "+r+";\n";return r=e,t}let r=n.valueToCode(e,"LIST",N.MEMBER)||"[]";var a=e.getFieldValue("MODE")||"GET",o=e.getFieldValue("WHERE")||"FROM_START",i=n.valueToCode(e,"TO",N.ASSIGNMENT)||"null";switch(o){case"FIRST":if("SET"===a)return r+"[0] = "+i+";\n";if("INSERT"===a)return r+".unshift("+i+");\n";break;case"LAST":if("SET"===a)return t()+(r+"["+r)+".length - 1] = "+i+";\n";if("INSERT"===a)return r+".push("+i+");\n";break;case"FROM_START":if(e=n.getAdjusted(e,"AT"),"SET"===a)return r+"["+e+"] = "+i+";\n";if("INSERT"===a)return r+".splice("+e+", 0, "+i+");\n";break;case"FROM_END":if(e=n.getAdjusted(e,"AT",1,!1,N.SUBTRACTION),o=t(),"SET"===a)return o+(r+"["+r)+".length - "+e+"] = "+i+";\n";if("INSERT"===a)return o+(r+".splice("+r)+".length - "+e+", 0, "+i+");\n";break;case"RANDOM":if(e=t(),e+="var "+(o=n.nameDB_.getDistinctName("tmpX",E.NameType$$module$build$src$core$names.VARIABLE))+" = Math.floor(Math.random() * "+r+".length);\n","SET"===a)return e+(r+"[")+o+"] = "+i+";\n";if("INSERT"===a)return e+(r+".splice(")+o+", 0, "+i+");\n"}throw Error("Unhandled combination (lists_setIndex).")},lists_sort:function(e,t){var n=t.valueToCode(e,"LIST",N.FUNCTION_CALL)||"[]",r="1"===e.getFieldValue("DIRECTION")?1:-1;return e=e.getFieldValue("TYPE"),[n+".slice().sort("+(t=t.provideFunction_("listsGetSortCompare",`
function ${t.FUNCTION_NAME_PLACEHOLDER_}(type, direction) {
  var compareFuncs = {
    'NUMERIC': function(a, b) {
        return Number(a) - Number(b); },
    'TEXT': function(a, b) {
        return String(a) > String(b) ? 1 : -1; },
    'IGNORE_CASE': function(a, b) {
        return String(a).toLowerCase() > String(b).toLowerCase() ? 1 : -1; },
  };
  var compare = compareFuncs[type];
  return function(a, b) { return compare(a, b) * direction; };
}
      `))+'("'+e+'", '+r+"))",N.FUNCTION_CALL]},lists_split:function(e,t){let n=t.valueToCode(e,"INPUT",N.MEMBER);if(t=t.valueToCode(e,"DELIM",N.NONE)||"''","SPLIT"===(e=e.getFieldValue("MODE")))n=n||"''",e="split";else{if("JOIN"!==e)throw Error("Unknown mode: "+e);n=n||"[]",e="join"}return[n+"."+e+"("+t+")",N.FUNCTION_CALL]}}),d={},O=(d.controls_if=t,d.controls_ifelse=t,d.logic_boolean=function(e,t){return["TRUE"===e.getFieldValue("BOOL")?"true":"false",N.ATOMIC]},d.logic_compare=function(e,t){var n={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[e.getFieldValue("OP")],r="=="===n||"!="===n?N.EQUALITY:N.RELATIONAL;return[(t.valueToCode(e,"A",r)||"0")+" "+n+" "+(e=t.valueToCode(e,"B",r)||"0"),r]},d.logic_negate=function(e,t){var n=N.LOGICAL_NOT;return["!"+(t.valueToCode(e,"BOOL",n)||"true"),n]},d.logic_null=function(e,t){return["null",N.ATOMIC]},d.logic_operation=function(e,t){var n="AND"===e.getFieldValue("OP")?"&&":"||",r="&&"==n?N.LOGICAL_AND:N.LOGICAL_OR;let a=t.valueToCode(e,"A",r);return e=t.valueToCode(e,"B",r),e=a||e?(t="&&"==n?"true":"false",a=a||t,e||t):a="false",[a+" "+n+" "+e,r]},d.logic_ternary=function(e,t){return[(t.valueToCode(e,"IF",N.CONDITIONAL)||"false")+" ? "+(t.valueToCode(e,"THEN",N.CONDITIONAL)||"null")+" : "+(e=t.valueToCode(e,"ELSE",N.CONDITIONAL)||"null"),N.CONDITIONAL]},{controls_flow_statements:function(e,t){let n="";var r;switch(t.STATEMENT_PREFIX&&(n+=t.injectId(t.STATEMENT_PREFIX,e)),t.STATEMENT_SUFFIX&&(n+=t.injectId(t.STATEMENT_SUFFIX,e)),!t.STATEMENT_PREFIX||(r=e.getSurroundLoop())&&!r.suppressPrefixSuffix&&(n+=t.injectId(t.STATEMENT_PREFIX,r)),e.getFieldValue("FLOW")){case"BREAK":return n+"break;\n";case"CONTINUE":return n+"continue;\n"}throw Error("Unknown flow statement.")},controls_for:function(t,n){var r=n.getVariableName(t.getFieldValue("VAR")),a=n.valueToCode(t,"FROM",N.ASSIGNMENT)||"0",o=n.valueToCode(t,"TO",N.ASSIGNMENT)||"0",i=n.valueToCode(t,"BY",N.ASSIGNMENT)||"1",u=n.statementToCode(t,"DO"),u=n.addLoopTrap(u,t);if(E.isNumber$$module$build$src$core$utils$string(a)&&E.isNumber$$module$build$src$core$utils$string(o)&&E.isNumber$$module$build$src$core$utils$string(i))t="for ("+r+" = "+a+"; "+r+((n=Number(a)<=Number(o))?" <= ":" >= ")+o+"; "+r,t=1===(r=Math.abs(Number(i)))?t+(n?"++":"--"):t+(n?" += ":" -= ")+r,t+=") {\n"+u+"}\n";else{t="";let e=a;a.match(/^\w+$/)||E.isNumber$$module$build$src$core$utils$string(a)||(t+="var "+(e=n.nameDB_.getDistinctName(r+"_start",E.NameType$$module$build$src$core$names.VARIABLE))+" = "+a+";\n"),(a=o).match(/^\w+$/)||E.isNumber$$module$build$src$core$utils$string(o)||(t+="var "+(a=n.nameDB_.getDistinctName(r+"_end",E.NameType$$module$build$src$core$names.VARIABLE))+" = "+o+";\n"),t+="var "+(o=n.nameDB_.getDistinctName(r+"_inc",E.NameType$$module$build$src$core$names.VARIABLE))+" = ",t=E.isNumber$$module$build$src$core$utils$string(i)?t+(Math.abs(Number(i))+";\n"):t+"Math.abs("+i+");\n",t=(t=(t+="if ("+e+" > "+a+") {\n")+(n.INDENT+o+" = -"+o+";\n"))+"}\nfor ("+r+" = "+e+"; "+o+" >= 0 ? "+r+" <= "+a+" : "+r+" >= "+a+"; "+r+" += "+o+") {\n"+u+"}\n"}return t},controls_forEach:function(e,t){var n=t.getVariableName(e.getFieldValue("VAR")),r=t.valueToCode(e,"LIST",N.ASSIGNMENT)||"[]",a=t.statementToCode(e,"DO"),a=t.addLoopTrap(a,e);e="";let o=r;return r.match(/^\w+$/)||(e+="var "+(o=t.nameDB_.getDistinctName(n+"_list",E.NameType$$module$build$src$core$names.VARIABLE))+" = "+r+";\n"),r=t.nameDB_.getDistinctName(n+"_index",E.NameType$$module$build$src$core$names.VARIABLE),a=t.INDENT+n+" = "+o+"["+r+"];\n"+a,e+("for (var "+r+" in "+o)+") {\n"+a+"}\n"}}),A=(O.controls_repeat=n,O.controls_repeat_ext=n,O.controls_whileUntil=function(e,t){var n="UNTIL"===e.getFieldValue("MODE");let r=t.valueToCode(e,"BOOL",n?N.LOGICAL_NOT:N.NONE)||"false",a=t.statementToCode(e,"DO");return a=t.addLoopTrap(a,e),"while ("+(r=n?"!"+r:r)+") {\n"+a+"}\n"},{math_arithmetic:function(e,t){var n=(r={ADD:[" + ",N.ADDITION],MINUS:[" - ",N.SUBTRACTION],MULTIPLY:[" * ",N.MULTIPLICATION],DIVIDE:[" / ",N.DIVISION],POWER:[null,N.NONE]}[e.getFieldValue("OP")])[0],r=r[1],a=t.valueToCode(e,"A",r)||"0";return e=t.valueToCode(e,"B",r)||"0",n?[a+n+e,r]:["Math.pow("+a+", "+e+")",N.FUNCTION_CALL]},math_atan2:function(e,t){var n=t.valueToCode(e,"X",N.NONE)||"0";return["Math.atan2("+(t.valueToCode(e,"Y",N.NONE)||"0")+", "+n+") / Math.PI * 180",N.DIVISION]},math_change:function(e,t){var n=t.valueToCode(e,"DELTA",N.ADDITION)||"0";return(e=t.getVariableName(e.getFieldValue("VAR")))+" = (typeof "+e+" === 'number' ? "+e+" : 0) + "+n+";\n"},math_constant:function(e,t){return{PI:["Math.PI",N.MEMBER],E:["Math.E",N.MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",N.DIVISION],SQRT2:["Math.SQRT2",N.MEMBER],SQRT1_2:["Math.SQRT1_2",N.MEMBER],INFINITY:["Infinity",N.ATOMIC]}[e.getFieldValue("CONSTANT")]},math_constrain:function(e,t){return["Math.min(Math.max("+(t.valueToCode(e,"VALUE",N.NONE)||"0")+", "+(t.valueToCode(e,"LOW",N.NONE)||"0")+"), "+(e=t.valueToCode(e,"HIGH",N.NONE)||"Infinity")+")",N.FUNCTION_CALL]},math_modulo:function(e,t){return[(t.valueToCode(e,"DIVIDEND",N.MODULUS)||"0")+" % "+(e=t.valueToCode(e,"DIVISOR",N.MODULUS)||"0"),N.MODULUS]},math_number:function(e,t){return e=Number(e.getFieldValue("NUM")),[String(e),0<=e?N.ATOMIC:N.UNARY_NEGATION]},math_number_property:function(e,t){var n={EVEN:[" % 2 === 0",N.MODULUS,N.EQUALITY],ODD:[" % 2 === 1",N.MODULUS,N.EQUALITY],WHOLE:[" % 1 === 0",N.MODULUS,N.EQUALITY],POSITIVE:[" > 0",N.RELATIONAL,N.RELATIONAL],NEGATIVE:[" < 0",N.RELATIONAL,N.RELATIONAL],DIVISIBLE_BY:[null,N.MODULUS,N.EQUALITY],PRIME:[null,N.NONE,N.FUNCTION_CALL]},r=e.getFieldValue("PROPERTY"),[a,o,i]=n[r],n=t.valueToCode(e,"NUMBER_TO_CHECK",o)||"0";return[e="PRIME"===r?t.provideFunction_("mathIsPrime",`
function ${t.FUNCTION_NAME_PLACEHOLDER_}(n) {
  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods
  if (n == 2 || n == 3) {
    return true;
  }
  // False if n is NaN, negative, is 1, or not whole.
  // And false if n is divisible by 2 or 3.
  if (isNaN(n) || n <= 1 || n % 1 !== 0 || n % 2 === 0 || n % 3 === 0) {
    return false;
  }
  // Check all the numbers of form 6k +/- 1, up to sqrt(n).
  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {
    if (n % (x - 1) === 0 || n % (x + 1) === 0) {
      return false;
    }
  }
  return true;
}
`)+"("+n+")":"DIVISIBLE_BY"===r?n+" % "+(e=t.valueToCode(e,"DIVISOR",N.MODULUS)||"0")+" === 0":n+a,i]},math_on_list:function(e,t){var n=e.getFieldValue("OP");switch(n){case"SUM":e=t.valueToCode(e,"LIST",N.MEMBER)||"[]",e+=".reduce(function(x, y) {return x + y;}, 0)";break;case"MIN":e="Math.min.apply(null, "+(e=t.valueToCode(e,"LIST",N.NONE)||"[]")+")";break;case"MAX":e="Math.max.apply(null, "+(e=t.valueToCode(e,"LIST",N.NONE)||"[]")+")";break;case"AVERAGE":e=(n=t.provideFunction_("mathMean",`
function ${t.FUNCTION_NAME_PLACEHOLDER_}(myList) {
  return myList.reduce(function(x, y) {return x + y;}, 0) / myList.length;
}
`))+"("+(e=t.valueToCode(e,"LIST",N.NONE)||"[]")+")";break;case"MEDIAN":e=(n=t.provideFunction_("mathMedian",`
function ${t.FUNCTION_NAME_PLACEHOLDER_}(myList) {
  var localList = myList.filter(function (x) {return typeof x === 'number';});
  if (!localList.length) return null;
  localList.sort(function(a, b) {return b - a;});
  if (localList.length % 2 === 0) {
    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;
  } else {
    return localList[(localList.length - 1) / 2];
  }
}
`))+"("+(e=t.valueToCode(e,"LIST",N.NONE)||"[]")+")";break;case"MODE":e=(n=t.provideFunction_("mathModes",`
function ${t.FUNCTION_NAME_PLACEHOLDER_}(values) {
  var modes = [];
  var counts = [];
  var maxCount = 0;
  for (var i = 0; i < values.length; i++) {
    var value = values[i];
    var found = false;
    var thisCount;
    for (var j = 0; j < counts.length; j++) {
      if (counts[j][0] === value) {
        thisCount = ++counts[j][1];
        found = true;
        break;
      }
    }
    if (!found) {
      counts.push([value, 1]);
      thisCount = 1;
    }
    maxCount = Math.max(thisCount, maxCount);
  }
  for (var j = 0; j < counts.length; j++) {
    if (counts[j][1] === maxCount) {
        modes.push(counts[j][0]);
    }
  }
  return modes;
}
`))+"("+(e=t.valueToCode(e,"LIST",N.NONE)||"[]")+")";break;case"STD_DEV":e=(n=t.provideFunction_("mathStandardDeviation",`
function ${t.FUNCTION_NAME_PLACEHOLDER_}(numbers) {
  var n = numbers.length;
  if (!n) return null;
  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;
  var variance = 0;
  for (var j = 0; j < n; j++) {
    variance += Math.pow(numbers[j] - mean, 2);
  }
  variance = variance / n;
  return Math.sqrt(variance);
}
`))+"("+(e=t.valueToCode(e,"LIST",N.NONE)||"[]")+")";break;case"RANDOM":e=(n=t.provideFunction_("mathRandomList",`
function ${t.FUNCTION_NAME_PLACEHOLDER_}(list) {
  var x = Math.floor(Math.random() * list.length);
  return list[x];
}
`))+"("+(e=t.valueToCode(e,"LIST",N.NONE)||"[]")+")";break;default:throw Error("Unknown operator: "+n)}return[e,N.FUNCTION_CALL]},math_random_float:function(e,t){return["Math.random()",N.FUNCTION_CALL]},math_random_int:function(e,t){var n=t.valueToCode(e,"FROM",N.NONE)||"0";return e=t.valueToCode(e,"TO",N.NONE)||"0",[t.provideFunction_("mathRandomInt",`
function ${t.FUNCTION_NAME_PLACEHOLDER_}(a, b) {
  if (a > b) {
    // Swap a and b to ensure a is smaller.
    var c = a;
    a = b;
    b = c;
  }
  return Math.floor(Math.random() * (b - a + 1) + a);
}
`)+"("+n+", "+e+")",N.FUNCTION_CALL]}}),_=(A.math_round=r,A.math_single=r,A.math_trig=r,{procedures_callnoreturn:function(e,t){return t.forBlock.procedures_callreturn(e,t)[0]+";\n"},procedures_callreturn:function(t,n){const e=n.getProcedureName(t.getFieldValue("NAME")),r=[],a=t.getVars();for(let e=0;e<a.length;e++)r[e]=n.valueToCode(t,"ARG"+e,N.NONE)||"null";return[e+"("+r.join(", ")+")",N.FUNCTION_CALL]}}),L=(_.procedures_defnoreturn=a,_.procedures_defreturn=a,_.procedures_ifreturn=function(e,t){let n="if ("+(t.valueToCode(e,"CONDITION",N.NONE)||"false")+") {\n";return t.STATEMENT_SUFFIX&&(n+=t.prefixLines(t.injectId(t.STATEMENT_SUFFIX,e),t.INDENT)),e.hasReturnValue_?(e=t.valueToCode(e,"VALUE",N.NONE)||"null",n+=t.INDENT+"return "+e+";\n"):n+=t.INDENT+"return;\n",n+"}\n"},/^\s*'([^']|\\')*'\s*$/),C={text:function(e,t){return[t.quote_(e.getFieldValue("TEXT")),N.ATOMIC]},text_append:function(e,t){var n=t.getVariableName(e.getFieldValue("VAR"));return e=t.valueToCode(e,"TEXT",N.NONE)||"''",n+" += "+s(e)[0]+";\n"},text_changeCase:function(e,t){var n={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[e.getFieldValue("CASE")];return e=t.valueToCode(e,"TEXT",n?N.MEMBER:N.NONE)||"''",[n?e+n:t.provideFunction_("textToTitleCase",`
function ${t.FUNCTION_NAME_PLACEHOLDER_}(str) {
  return str.replace(/\\S+/g,
      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});
}
`)+"("+e+")",N.FUNCTION_CALL]},text_charAt:function(e,t){var n=e.getFieldValue("WHERE")||"FROM_START",r=t.valueToCode(e,"VALUE","RANDOM"===n?N.NONE:N.MEMBER)||"''";switch(n){case"FIRST":return[r+".charAt(0)",N.FUNCTION_CALL];case"LAST":return[r+".slice(-1)",N.FUNCTION_CALL];case"FROM_START":return[r+".charAt("+(e=t.getAdjusted(e,"AT"))+")",N.FUNCTION_CALL];case"FROM_END":return[r+".slice("+(e=t.getAdjusted(e,"AT",1,!0))+").charAt(0)",N.FUNCTION_CALL];case"RANDOM":return[t.provideFunction_("textRandomLetter",`
function ${t.FUNCTION_NAME_PLACEHOLDER_}(text) {
  var x = Math.floor(Math.random() * text.length);
  return text[x];
}
`)+"("+r+")",N.FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},text_count:function(e,t){var n=t.valueToCode(e,"TEXT",N.NONE)||"''";return e=t.valueToCode(e,"SUB",N.NONE)||"''",[t.provideFunction_("textCount",`
function ${t.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle) {
  if (needle.length === 0) {
    return haystack.length + 1;
  } else {
    return haystack.split(needle).length - 1;
  }
}
`)+"("+n+", "+e+")",N.FUNCTION_CALL]},text_getSubstring:function(e,t){var n={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"},r=e.getFieldValue("WHERE1"),a=e.getFieldValue("WHERE2"),o="FROM_END"!==r&&"LAST"!==r&&"FROM_END"!==a&&"LAST"!==a,i=t.valueToCode(e,"STRING",o?N.MEMBER:N.NONE)||"''";if("FIRST"===r&&"LAST"===a)return[i,N.NONE];if(i.match(/^'?\w+'?$/)||o){switch(r){case"FROM_START":n=t.getAdjusted(e,"AT1");break;case"FROM_END":n=i+".length - "+(n=t.getAdjusted(e,"AT1",1,!1,N.SUBTRACTION));break;case"FIRST":n="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(a){case"FROM_START":t=t.getAdjusted(e,"AT2",1);break;case"FROM_END":t=i+".length - "+(t=t.getAdjusted(e,"AT2",0,!1,N.SUBTRACTION));break;case"LAST":t=i+".length";break;default:throw Error("Unhandled option (text_getSubstring).")}i=i+".slice("+n+", "+t+")"}else o=t.getAdjusted(e,"AT1"),e=t.getAdjusted(e,"AT2"),i=t.provideFunction_("subsequence"+n[r]+n[a],`
function ${t.FUNCTION_NAME_PLACEHOLDER_}(sequence${"FROM_END"===r||"FROM_START"===r?", at1":""}${"FROM_END"===a||"FROM_START"===a?", at2":""}) {
  var start = ${T("sequence",r,"at1")};
  var end = ${T("sequence",a,"at2")} + 1;
  return sequence.slice(start, end);
}
`)+"("+i+("FROM_END"===r||"FROM_START"===r?", "+o:"")+("FROM_END"===a||"FROM_START"===a?", "+e:"")+")";return[i,N.FUNCTION_CALL]},text_indexOf:function(e,t){var n="FIRST"===e.getFieldValue("END")?"indexOf":"lastIndexOf",r=t.valueToCode(e,"FIND",N.NONE)||"''";return t=(t.valueToCode(e,"VALUE",N.MEMBER)||"''")+"."+n+"("+r+")",e.workspace.options.oneBasedIndex?[t+" + 1",N.ADDITION]:[t,N.FUNCTION_CALL]},text_isEmpty:function(e,t){return["!"+(t.valueToCode(e,"VALUE",N.MEMBER)||"''")+".length",N.LOGICAL_NOT]},text_join:function(t,n){switch(t.itemCount_){case 0:return["''",N.ATOMIC];case 1:return t=n.valueToCode(t,"ADD0",N.NONE)||"''",s(t);case 2:var r=n.valueToCode(t,"ADD0",N.NONE)||"''";return t=n.valueToCode(t,"ADD1",N.NONE)||"''",[s(r)[0]+" + "+s(t)[0],N.ADDITION];default:r=Array(t.itemCount_);for(let e=0;e<t.itemCount_;e++)r[e]=n.valueToCode(t,"ADD"+e,N.NONE)||"''";return["["+r.join(",")+"].join('')",N.FUNCTION_CALL]}},text_length:function(e,t){return[(t.valueToCode(e,"VALUE",N.MEMBER)||"''")+".length",N.MEMBER]},text_multiline:function(e,t){return t=-1!==(e=t.multiline_quote_(e.getFieldValue("TEXT"))).indexOf("+")?N.ADDITION:N.ATOMIC,[e,t]},text_print:function(e,t){return"window.alert("+(t.valueToCode(e,"TEXT",N.NONE)||"''")+");\n"}},M=(C.text_prompt=o,C.text_prompt_ext=o,C.text_replace=function(e,t){var n=t.valueToCode(e,"TEXT",N.NONE)||"''",r=t.valueToCode(e,"FROM",N.NONE)||"''";return e=t.valueToCode(e,"TO",N.NONE)||"''",[t.provideFunction_("textReplace",`
function ${t.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle, replacement) {
  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g, '\\\\$1')
                 .replace(/\\x08/g, '\\\\x08');
  return haystack.replace(new RegExp(needle, 'g'), replacement);
}
`)+"("+n+", "+r+", "+e+")",N.FUNCTION_CALL]},C.text_reverse=function(e,t){return[(t.valueToCode(e,"TEXT",N.MEMBER)||"''")+".split('').reverse().join('')",N.FUNCTION_CALL]},C.text_trim=function(e,t){var n={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[e.getFieldValue("MODE")];return[(t.valueToCode(e,"TEXT",N.MEMBER)||"''")+n,N.FUNCTION_CALL]},{}),R=(M.variables_get=i,M.variables_set=u,{}),m=(R.variables_get_dynamic=i,R.variables_set_dynamic=u,new e),f=Object.assign({},c,I,d,O,A,_,C,M,R);for(const h in f)m.forBlock[h]=f[h];c={};return c.JavascriptGenerator=e,c.Order=N,c.javascriptGenerator=m,c.__namespace__=E,c});